package com.asiainfo.dygj.test;

import com.asiainfo.dygj.bean.BaseStationInfo;
import com.asiainfo.dygj.monitor.Constant;
import com.asiainfo.dygj.monitor.OracleDBTools;
import com.asiainfo.dygj.sourcefunc.OracleCustomSource;
import org.apache.flink.api.common.functions.FlatMapFunction;
import org.apache.flink.api.java.utils.ParameterTool;
import org.apache.flink.streaming.api.datastream.DataStreamSource;
import org.apache.flink.streaming.api.datastream.SingleOutputStreamOperator;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.util.Collector;

import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Map;

/***********************************
 *@Desc TODO
 *@ClassName OracleTest
 *@Author DLX
 *@Data 2020/8/17 16:29
 *@Since JDK1.8
 *@Version 1.0
 ***********************************/
public class OracleTest {
    private final static String NOW_TIME = "yyyy-MM-dd HH:mm:ss";
    public static void main(String[] args) {
        String str = "1;8305;53001;202105;53001021<43020141:53001021:54000126,>;;53001001;;70020242;-1;71330008348929;5014219468;69000450;460028684249840;15868826416;3567021154863706;571;571;5711;571;571;;20210512083541;3212;126;0;7149067995543470379;43020141;0;40;;0;0;;0;0;;0;0;{5014219468,75008017,6033041,571,69004503034980,126,20210401000000,20210501000000:17273201,104857600,3000};{5014219468,8050,571,126,20210501000000,20210601000000:7583276,209715200};2;1;DF672E63;0;1;571D;C8E2446;10;873931803;DF672E6A;CMNET;;018d;24098928046C03450000000000000000;8;1;0400;0;46002;2;;444;0;2;HZSAEGW138BHW;;;0;0;2;N2000000002;2000000002;48422;80523;;;;0;0;0;0;0;0;0;0;0;0;0;48422;80523;20210512083541;3212;;0;0;0;0;0;0;0;0;0;0;0;0;0;;0;0;;;;1;;;;LTECG93_HZCG71_PGWCDR_20210512104703_05743276.dat;20210512104747;20210512;126;;;;2;15;3;;;;;;20210512083000;;114547377;;4;;;;3212;DR_GGPRS_HZ_6_20210512;;;;;;;4;;;20210512104811;;{5014219468,43020141,70470003,571,20210501000000,20210601000000,0,0,6216920,0,0,0,126};141544942207616;{6033041:126:1}{43020141:0:126};;;\n" +
                "1;8305;53001;202105;53001021<43020141:53001021:54000126,>;;53001001;;70019172;-1;71330001405126;71331001316335;69000450;460071571617930;19858163446;8679510436900639;571;571;5713;571;571;;20210512103949;468;1932;0;;43020141;0;550;;0;0;;0;0;;0;0;{71331001316335,90129086,6033471,571,69004235254573,1932,20210501000000,20210601000000:7301791,52428800,1};{71331001316335,8050,571,1932,20210501000000,20210601000000:8082917,209715200}{71331001316335,73804020,571,1932,20210501000000,20210601000000:8082861,209715200};2;1;DF673091;0;1;5814;6083E05;1;126149172;DF673099;CMNET;;018d;240989280A9403A40000000000000000;16;1;0400;0;46007;1;;1;0;2;HZSAEGW166BHW;;;0;0;2;N1750000003,N2000000002,N2000000009;2000000002;189740;1788358;;;;0;0;0;0;0;0;0;0;0;0;0;189740;1788358;20210512103949;0;;0;0;0;0;0;0;0;0;0;0;0;0;0;;0;0;;;;1;;;;LTECG108_HZCG19_PGWCDR_20210512104745_10173648.dat;20210512104822;20210512;1932;;;;2;15;3;;;;;;20210512103949;;0;;;;;;468;DR_GGPRS_HZ_6_20210512;;;;;;;4;;;20210512104838;;{71331001316335,43020141,70470003,571,20210501000000,20210601000000,0,0,8082861,0,0,0,1932};141544942207616;{6033471:1932:1}{43020141:0:1932};;;";
        String[] split = str.split(";\\{");

        LocalDateTime time = LocalDateTime.now();
        String format = time.format(DateTimeFormatter.ofPattern(NOW_TIME));
        String sql = "insert into GGRPSNUM values (?, TO_TIMESTAMP(?, 'yyyy-mm-dd hh24:mi:ss'))";
        OracleDBTools.excutemonitor(sql, Constant.TEST, split[0], format);
    }
}
